<!DOCTYPE html>
<html>
    <head>
        <title>Games</title>
        <meta name='page-banner' content="./images/DarkBackground.jpg">

        <link rel="stylesheet" href="./style.css">
        <script src="./pages.js"></script>

        <style>
            #main-content{padding-bottom: 100px;}
            section{
                display: flex;
                flex-wrap: wrap;
                padding: 10px;
            }
            #main-content a {
                background-size:cover;
                background-position: center;
                width: 50%;
                height: 300px;
                overflow: hidden;
            }
            h1 {
                margin: 30px auto;
                margin-right: 20%;
            }
            a div{
                width: 100%;
                height: 100%;
                animation: fadeOut .3s;
                opacity: 0;
                position: relative;
            }
            a div:hover{animation: fadeIn .3s;opacity: 1;}
            a video{width: 100%;z-index: 1;}
            a div:before{
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-image: linear-gradient(rgba(0,0,0,0),rgba(0,0,0,.7));
                z-index: 0.9;
            }
            a h2{
                margin: 10px auto;
                position: absolute;
                bottom: 0;
                left: 50%;
                transform: translate(-50%);
                z-index: 1;
            }

            @keyframes fadeIn  {from{opacity: 0} to {opacity: 1}}
            @keyframes fadeOut {from{opacity: 1} to {opacity: 0}}
        </style>
    </head>
    <body>
        <h1>Games</h1>
        <section></section>

        <script>
            // Make Game Elements
            class Game {
                constructor(name='Unnamed', page='#', cover='./images/DarkBackground.jpg', video=null) {
                    this.name  = name
                    this.cover = cover
                    this.video = video
                    this.page  = page
                }
                appendElement() {
                    // make html element, return it
                    let a = document.createElement('a')
                    a.href = this.page
                    a.style.backgroundImage = `url(${this.cover})`
                    a.className = 'game'

                    let div = document.createElement('div')
                    let video = document.createElement('video')
                    video.autoplay = true
                    video.muted    = true
                    video.loop     = true
                    video.src      = this.video

                    let h2 = document.createElement('h2')
                    h2.innerText = this.name

                    if(this.video != null) div.appendChild(video)
                    div.appendChild(h2)

                    a.appendChild(div)

                    document.getElementsByTagName('section')[0]
                        .appendChild(a)
                }
            }

            const games = [
                new Game(
                    'Sinwave', './games/sinwave.html',
                    './images/games/sinewave-cover.png'
                ),
                new Game(
                    'Unended', './games/unended.html',
                    './images/games/unended-cover.jpg'
                )
            ]
            const gameresize = ()=>{
                let el = document.getElementsByClassName('game'),
                    ratio = 430 / 768

                for(let i = 0; i < el.length; i++) {
                    //console.log(el[i])
                    el[i].style.height = window.innerWidth / 2 * ratio + 'px'
                }
            }

            for(let i of games) i.appendElement()

            gameresize()
            window.addEventListener('resize', gameresize)
        </script>
    </body>
</html>